getwd()
library(tidyverse)
library(knitr)
library(janitor)
library(dplyr )
library(ggplot2)
library(reshape2)
library(bold)
library(msa)
library(seqRFLP)
#if (!requireNamespace("BiocManager", quietly=TRUE))
#install.packages("BiocManager")
#BiocManager::install("msa")
#if (!require("BiocManager", quietly = TRUE))
#install.packages("BiocManager")
#BiocManager::install("ggtree")
bdj<-read_tsv("DS-KROK4BDJ.txt", show_col_types = FALSE )
getwd()
getwd()
library(tidyverse)
library(knitr)
library(janitor)
library(dplyr )
library(ggplot2)
library(reshape2)
library(bold)
library(msa)
library(seqRFLP)
#if (!requireNamespace("BiocManager", quietly=TRUE))
#install.packages("BiocManager")
#BiocManager::install("msa")
#if (!require("BiocManager", quietly = TRUE))
#install.packages("BiocManager")
#BiocManager::install("ggtree")
bdj<-read_tsv("DS-KROK4BDJ.txt", show_col_types = FALSE )
column_names <- colnames(bdj)
view(bdj)
dim(bdj)
kable(column_names)
kable(bdj[1:5])
bdj$phylum_taxID = as.factor(as.numeric(bdj$phylum_taxID))
bdj$class_taxID = as.factor(as.numeric(bdj$class_taxID))
bdj$order_taxID = as.factor(as.numeric(bdj$order_taxID))
bdj$family_taxID = as.factor(as.numeric(bdj$family_taxID))
bdj$genus_taxID = as.factor(as.numeric(bdj$genus_taxID))
bdj$species_taxID = as.factor(as.numeric(bdj$species_taxID))
bdj$subspecies_taxID = as.factor(as.numeric(bdj$subspecies_taxID))
bdj$phylum_name = as.factor(as.character(bdj$phylum_name))
bdj$class_name = as.factor(as.character(bdj$class_name))
bdj$order_name = as.factor(as.character(bdj$order_name))
bdj$family_name = as.factor(as.character(bdj$family_name))
bdj$genus_name = as.factor(as.character(bdj$genus_name))
bdj$species_name = as.factor(as.character(bdj$species_name))
bdj$subspecies_name = as.factor(as.character(bdj$subspecies_name))
unique(bdj$family_name) %>% as.matrix(family_name) -> family_name_view
kable(family_name_view)
ggplot(bdj, aes(x=reorder(family_name, family_name, function(x)-length(x)),fill=family_name)) +
geom_bar() +
labs(title="Individuals per Family",
x="Family Name", y = "Count") +
theme(axis.text.x = element_text(angle = 90))
ggplot(bdj, aes(x=reorder(genus_name, genus_name, function(x)-length(x)),fill=genus_name)) +
geom_bar() +
labs(title="Individuals per Genus",
x="Family Name", y = "Count") +
theme(axis.text.x = element_text(angle = 90)) +
theme(legend.position="none")
phylo <- bdj
phylo_bold <- bold_seq(taxon = NULL, ids = phylo$processid, bin = phylo$bin_uri, container = NULL, institutions = NULL,
researchers = NULL, geo = NULL, marker = "COI-5P", response = FALSE)
bdj%>% filter(!duplicated(.[["bin_uri"]])) -> unique_binuri
bdj%>% filter(!duplicated(.[["processid"]])) -> unique_processid
sum(is.na(phylo$bin_uri))
phylo_bold_df<- as.data.frame(matrix(unlist(phylo_bold, use.names = FALSE), ncol = 4, byrow= TRUE))
phylo_bold_trim <- as.tibble(phylo_bold_df) %>%select(1,2,4)
colnames(phylo_bold_trim) = c("ID", "name", "sequence")
phylo_bold_combo<- phylo_bold_trim %>% unite("name", 1:2, na.rm = TRUE, remove = TRUE)
class(phylo_bold_combo)
bold_combo_df <- as.data.frame(phylo_bold_combo)
phylo_bold.fasta = dataframe2fas(bold_combo_df, file = "phylo_bold.fasta")
mySequencesphylo <- readDNAStringSet("phylo_bold.fasta")
phylo_alignment <- msa(mySequencesphylo)
phylo_alignment
